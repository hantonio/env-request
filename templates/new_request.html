{% extends "bootstrap/base.html" %}

{% block title %}New Request - Environment Request{% endblock %}

{% block content %}
<div class="container">
<h2>New Request</h2>

{% from "_formhelpers.html" import render_field %}
<form method=post>
	<dl>
		{{ render_field(form.environment) }}
		{{ render_field(form.requestedby) }}
		{{ render_field(form.version) }}
		{{ render_field(form.swp_number) }}
        {{ render_field(form.start_date, type='datetime-local') }}
		{{ render_field(form.delivery_date, type='datetime-local') }}
		{{ render_field(form.backup_db) }}
		{{ render_field(form.keep_data) }}
		{{ render_field(form.keep_ld) }}						
		{{ render_field(form.osb_integration) }}
		{{ render_field(form.ods_integration) }}
		{{ render_field(form.oss_integration) }}				
		{{ render_field(form.source_uat_ref) }}		
		{{ render_field(form.delivery_notification) }}		
	</dl>
	<p><input type=submit value=Submit></p>
</form>
</div>
{% endblock %}

{% block scripts %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script>
jQuery.fn.filterByText = function(textbox, selectSingleMatch) {
  return this.each(function() {
    var select = this;
    var options = [];
    $(select).find('option').each(function() {
      options.push({value: $(this).val(), text: $(this).text()});
    });
    $(select).data('options', options);
    $(textbox).bind('change keyup', function() {
      var options = $(select).empty().scrollTop(0).data('options');
      var search = $.trim($(this).val());
      var regex = new RegExp(search,'gi');
 
      $.each(options, function(i) {
        var option = options[i];
        if(option.text.match(regex) !== null) {
          $(select).append(
             $('<option>').text(option.text).val(option.value)
          );
        }
      });
      if (selectSingleMatch === true && 
          $(select).children().length === 1) {
        $(select).children().get(0).selected = true;
      }
    });
  });
};
$(function() {
  $('#selectswp').filterByText($('#versionbox'), true);
}); 
</script>
{% endblock%}